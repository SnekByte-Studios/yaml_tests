---
name: Testmepls
on:
  pull_request:
    types: [opened, reopened]
  push:

jobs:
  setup:
    runs-on: ubuntu-latest
    outputs:
      USERNAME: "Ryboster"
      TOKEN: ${{ secrets.SECRET_TOKEN }}
      REPO: ${{ secrets.REPO }}
      OWNER: ${{ secrets.OWNER }}
      open_request_ids: ${{ steps.fetch.outputs.open_request_ids }}
      
    steps:
      - name: Fetch Variables
        id:  fetch
        run: |
          open_request_ids=`curl -L \
          -H "Accept: application/vnd.github+json" \
          -H "Authorization: Bearer ${{ env.TOKEN }}" \
          -H "X-GitHub-Api-Version: 2022-11-28" \
          https://api.github.com/repos/${{ env.OWNER }}/${{ env.REPO }}/pulls \
          | jq -r .[].head.sha`
          echo "::set-output name=open_request_ids::$open_request_ids"

  job2:
    needs: setup
    runs-on: ubuntu-latest
    inputs:
      open_request_ids: ${{ jobs.setup.outputs.open_request_ids }}
    run: |
      echo ${{ needs.setup.outputs.open_request_ids }}
      echo ${{ needs.setup.outputs.USERNAME }}
...
